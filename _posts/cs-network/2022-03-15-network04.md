---
title:  "[모두의 네트워크] 4장 데이터 링크 계층"
excerpt: "랜에서 데이터 전송하기"

categories:
  - Network
tags:
  - [Network, 모두의 네트워크]

toc: true
toc_sticky: true
 
date: 2022-03-17
last_modified_at: 2022-03-17
---

~~너무 귀찮아도~~ OSI 모델 2계층인 데이터 링크 계층에 대해 알아보자!👏  
물리 계층에 대해 아마도 까먹었을 것 같으니 2장에서 정리했던 데이터 흐름을 복습해보자!
<details>
<summary>데이터 흐름</summary>
<div markdown="1">

```
✔️  일반적으로 5계층(세션계층), 6계층(표현계층)은   7계층(응용계층)에 포함되어 생각 할 수 있다.

                                        데이터 송신부                                                    데이터 수신부
응용계층                           (웹사이트 요청데이터)                      ↓                   ↑   (웹사이트 요청 데이터)
------------------------------------------------------------------------------↓ 캡             역 ↑---------------------------------------------
전송계층                      [전송계층헤더]--> (데이터)                      ↓ 슐             캡 ↑   [전송계층헤더]<-- (데이터)
------------------------------------------------------------------------------↓ 화             슐 ↑----------------------------------------------
네트워크계층        [네트워크계층헤더]--> (헤더)(데이터)                      ↓                화 ↑   [네트워크계층헤더]<-- (헤더)(데이터)
------------------------------------------------------------------------------↓                   ↑----------------------------------------------
데이터링크계층  [데이터링크계층]--> (헤더)(헤더)(데이터) <--[데이터링크계층]  ↓                   ↑   [데이터링크계층]<-- (헤더)(헤더)(데이터) -->[데이터링크계층]
                      헤더                                      트레일러      ↓                   ↑        헤더                                      트레일러
------------------------------------------------------------------------------↓-------------------↑----------------------------------------------   
물리계층                                                                      +-->전기신호 변환>--+ 
                                                                         (헤더)(헤더)(헤더)(데이터)(트레일러)
🤓 트레일러 : 데이터에 전달할때 마지막에 추가하는 정보
🤓 [데이터링크계층 헤더][네트워크계층 헤더][전송계층 헤더][웹사이트 요청데이터][데이터링크계층 트레일러] 가 전기신호로 변환되어 수신측에 도착.
```
</div>
</details>

*********************
<br/><br/><br/>

# ✏️ Lesson 12 데이터 링크 계층의 역할과 이더넷  
랜에서는 데이터를 주고받는 규칙으로 **이더넷**을 사용한다.

## ✔️ 이더넷이란?
: 허브와 같은 장비에 연결된 컴퓨터와 데이터를 주고받을 때(==랜 에서) 사용하는 규칙  

### 1. 데이터 링크 계층
: 네트워크 장비 간에 신호를 주고 받는 규칙을 정하는 계층
- 일반적으로 많이 사용되는 규칙이 **이더넷**

### 2. "더미" 허브
: 약해지거나 파형이 망가진 전기 신호 복원 및 전기 신호를 **다른 모든 포트에 전달**
  <span style = " font-size:0.8em; color: dark-gray;">기억 안나면 3장 복습!</span>  
```
                +-----------------------------+
                |             허브            |
                +---↑-----↓-----↓-----↓-----↓-+
                  tx↑   rx↓   rx↓   rx↓   rx↓ 
                    ↑     ↓     X     X     X
                    ↑     ↓ 무시X 무시X 무시X 
                   PC1   PC2   PC3   PC4   PC5
        🤓 목적지가 아닌 컴퓨터는 해당 데이터를 무시하도록 하는 규칙이 있으니 안심해도 된다!
```  

- **충돌(Collision)** 발생  
컴퓨터 여러대가 동시에 데이터를 보내면 서로 부딪힌다.  
<span style = " font-size:0.8em; color: dark-gray;">기억 안나면 3장 복습!</span>  
```
PC1, PC5 에서 데이터를 전송하려는 경우
                +-----------------------------+
                |             허브            |
                +---↑-----↓-----↓-----↓-----↓-+
                  tx↑   rx↓   rx↓   rx↓   rx↓ 
                    ↑     ↓     ↓     ↓     💣충돌!
                    ↑     ↓     ↓     ↓   tx↑ 
                   PC1   PC2   PC3   PC4   PC5
```  

### 3. CSMA/CD
: 반송파 감지 다중 접속 및 충돌 탐지
(Carrier Sense Multiple Access with Collision Detection)
- **CS**(Carrier Sense) : '데이터를 보내려고 하는 컴퓨터가 케이블에 신호가 흐르는지 아닌지 확인한다.'
- **MA**(Multiple Access) : '케이블에 데이터가 흐르지 않는다면 데이터를 보내도 된다.'
- **CD**(Collision Detection) : '충돌이 발생하고 있는지 확인한다'
  ```
  PC1, PC5 에서 데이터를 전송하려는 경우
  CSMA/CD
        +-----------------------------+
        |            허브             |
        +---↑-----↓-----↓-----↓-----↓-+
          tx↑   rx↓   rx↓   rx↓   rx↓           
            ↑     ↓     ↓     ↓     ↓
            ↑     ↓     ↓     ↓     ↓
           PC1   PC2   PC3   PC4   PC5
                                    👆 사용중인 케이블이므로 tx 대기 후 전송
  ``` 

## 📄 Lesson 12 정리
- 이더넷은 랜에서 데이터를 정상으로 주고받기 위한 규칙이다.
- 이더넷은 데이터 충돌을 막기 위한 규칙으로 CSMA/CD방식을 사용한다.
- CSMA/CD에서   
  CS는 데이터를 보내려는 컴퓨터가 케이블에 신호가 흐르고 있는지 확인하는 규칙,  
  MA는 케이블에 데이터가 흐르고 있지 않으면 데이터를 보내도 된다는 규칙,
  CD는 충돌이 발생하고 있는지 확인하는 규칙이다.

*************
<br/><br/><br/><br/>

# ✏️ Lesson 13 MAC 주소의 구조
## ✔️ MAC 주소란?

### 1. 물리 주소  
: MAC 주소(Media Access Control Address)
- 랜 카드 안에 있는 주소
- 전세계에서 유일한 고유 번호 (랜 카드 제조시 생성)
- 48bit = 앞 24bit(랜 카드 제조사 번호) + 뒤 24bit(랜 카드 일련번호)

### 2. 프레임  
: **이더넷 헤더**와 **트레일러**가 추가된 데이터 

#### 2-1. 이더넷 헤더
: `14byte [**이더넷 헤더**]` = `6byte [목적지 MAC 주소]` + `6byte [출발지 MAC 주소]` + `2byte [유형]`
- 유형 : 이더넷으로 전송되는 상위 계층 프로토콜의 종류를 식별하는 번호다.  
  ex) IPv4 : 0800, IPv6 : 86DD  
    ```
            MAC Address                                             |
    PC1 : AA-AA-AA-AA-AA-AA ---+                                    |
    PC2 : BB-BB-BB-BB-BB-BB    |Data(A->C)                          |
    PC3 : CC-CC-CC-CC-CC-CC <--+                                    |
    PC4 : DD-DD-DD-DD-DD-DD                                         |
    PC5 : EE-EE-EE-EE-EE-EE                                         |
    ----------------------------------------------------------------|
    Frame                                                           |
    [도착지 MAC 주소] [출발지 MAC 주소] [유형] [데이터] [트레일러]  |
    CC-CC-CC-CC-CC-CC AA-AA-AA-AA-AA-AA  86DD                       |
    ⎿______________이더넷 헤더______________⏌                     |
    ```

#### 2-2. 트레일러
: **FCS(Frame Check Sequence)**라고도 불리며 데이터 전송 도중 오류가 발생하는지 확인하는 용도이다.

### 3. 데이터 흐름
- 아까와 같이 PC1 -> PC3으로 데이터를 보내는 상황을 가정하면
```
      1번 포트로부터 데이터 수신 후 나머지 포트에 송신
        +----------------------------------------+
        |                   허브                 |
        +----------------------------------------+
            ↑       ↓        ↓       ↓      ↓
            ↑      파기    수신    파기    파기
            ↑       X        O       X      X
           PC1     PC2     PC3     PC4     PC5
```
- 만약에 PC1 -> PC3, PC2 -> PC3 이 동시에 발생한다면?
  - PC3 포트에서 충돌이 발생한다.
  - CSMA/CD규칙에 의해 충돌이 detect되고 PC2는 대기했다가 데이터를 재전송한다.

## 📄 Lesson 13 정리
- MAC 주소는 48비트 숫자로 구성되어 있다.  
  그 중 앞쪽 24비트는 랜카드를 만든 제조사 번호, 뒤쪽 24비트는 제조사가 할당한 일련번호다.
- 이더넷 헤더는 도착지 MAC주소(6바이트), 출발지 MAC주소(6바이트), 유형(2바이트)로 총 14바이트로 구성된다.
- 데이터 링크 계층에서 데이터 뒤에 추가하는 것을 트레일러라고 한다.  

*************
<br/><br/><br/><br/>

# ✏️ Lesson 14 스위치의 구조
## ✔️ MAC주소 테이블이란?

### 스위치

- 데이터 링크 계층에서 동작해서 **L2 스위치**라고도 불린다
- 허브하고 외형이 거의 비슷해서 **스위치 허브**라고도 불린다.
- 스위치에는 **MAC 주소 학습 기능**이 있다.  
> **MAC 주소 테이블** : 스위치의 포트번호와 해당 포트에 연결되어 있는 컴퓨터의 MAC주소가 등록되는 데이터베이스  
> a.k.a 브리지 테이블(Bridge table)  
  - 최초에 스위치 전원을 켰을 때는 MAC 주소 테이블에 아무것도 등록되어있지 않다.
  - 컴퓨터에서 프레임이 전송되면 MAC주소테이블을 확인하고 등록되어 있지 않으면  
    출발지 MAC 주소를 포트와 함께 등록한다.
  - **플러딩** : 목적지 MAC 주소가 MAC 주소 테이블에 등록되어 있지 않아  
    송신 포트 이외의 모든 포트에 프레임이 전송되는 현상.
  - **MAC 주소 필터링** : MAC 주소 기준으로 목적지를 선택하는 것. 이것을 못하면 플러딩이 발생
- 위와 같은 이유로 대부분 허브보다 스위치를 많이 사용한다.

## 📄 Lesson 14 정리
- 스위치는 데이터 링크 계층에서 동작하며, 레이어2 스위치 또는 스위칭 허브라고 부른다.
- 스위치에는 MAC 주소 테이블이 있다.
- MAC 주소 테이블은 스위치의 포트 번호와 그 포트에 연결되어 있는 컴퓨터의 MAC 주소가 등록되는 데이터베이스다.
- 스위치가 수신 포트 이외의 모든 포트에서 데이터를 송신하는 것을  플러딩이라고 한다.
- 스위치에서 MAC주소를 기준으로 목적지를 선택하는 것을 MAC 주소 필터링이라고 한다.

*************
<br/><br/><br/><br/>

# ✏️ Lesson 15 데이터가 케이블에서 충돌하지 않는 구조
## ✔️ 전이중 통신과 반이중 통신
- 전이중 통신 : 데이터의 송수신을 **동시**에 하는 방식
- 반이중 통신 : 회선 하나로 송신과 수신을 **번갈아가면서**하는 방식

### 전이중 통신(Full-Duplex)
- 데이터를 동시에 전송해도 문제가 없다.
- ex) 컴퓨터 2대를 랜케이블(크로스 케이블)로 직접 연결한 경우
- ex) 스위치와 컴퓨터 연결 한 경우 : 충돌 걱정X

### 반이중 통신(Half-Duplex)
- 데이터를 동시에 전송하면 충돌이 발생한다.
- ex) 허브와 컴퓨터를 연결 한 경우 (CSMA/DA규칙 사용)

## ✔️ 충돌 도메인이란?
(Collision Domain) 충돌이 발생할 때 그 영향이 미치는 범위
- 허브의 경우 접속된 모든 컴퓨터에 영향을 미치므로 모든 컴퓨터가 충돌 도메인이 된다.
- 스위치는 전이중 통신 방식이기 때문에 충돌이 일어나지 않는다. 따라서 충돌 도메인의 범위도 좁다. (충돌이 발생한 해당 컴퓨터)
- 충돌 도메인의 범위가 넓을 수록 네트워크가 지연된다! 따라서 좁히는 것이 중요.

## ✔️ 보강 ARP
:Address Resolutino Protocol 은 목적지 컴퓨터의 IP주소를 이용하여 MAC 주소를 찾기 위한 프로토콜이다.  
이더넷 프레임을 전송하려면 목적지 컴퓨터의 MAC 주소를 지정해야 한다.  
- 출발지 PC가 목적지 주소를 모르면 MAC 주소를 알아내기 위해 네트워크에 **브로드캐스트**하는데 이것이 **ARP 요청**이다!  
이 요청에 대해 지정된 IP 주소를 가지고 있지 않은 PC는 응답하지 않는다.  
- 지정된 IP주소를 가진 PC는 자신의 MAC주소를 응답으로 보낸다. 이것을 **ARP 응답**이라고 한다.  
이 응답을 기반으로 출발지 PC는 목적지 MAC주소를 얻고 이더넷 프레임을 만들 수 있다!  
- 또한 MAC주소를 얻은 후 IP주소와 MAC주소의 매핑정보를 메모리에 보관하는데, 이 정보를 **ARP 테이블**이라고 한다.  
이후 통신은 ARP테이블을 참고하여 전송한다.  
- IP주소가 변경되면 해당 MAC주소도 변경되므로 일정시간이 지나면 정보를 삭제하고 다시 ARP요청을 한다.
이 정보는 윈도우 기준 arp -p로 확인할 수 있고, ARP 캐시를 삭제하려면 arp -d 하면 된다.


## 📄 Lesson 15 정리
- 전이중 통신 방식이란 데이터의 수신과 송신을 동시에 하는 통신 방식이다.
- 반이중 통신 방식은 회선 한개로 송신과 수신을 번갈아가면 수행하는 통신 방식이다.
- 데이터 충돌이 발생하고 그 충돌 영향이 미치는 범위를 충돌 도메인이라고 한다.

*************
<br/><br/><br/><br/>

# ✏️ Lesson 16 이더넷의 종류와 특징
## ✔️ 이더넷 규격
: 종류나 통신 속도에 따라 이더넷을 다양한 규격으로 분류한다.
- 주요 이더넷 규격
  - 10BASE5, 10BASE2, 10BASE-T, 10BASEE2, 100BASE-TX, 1000BASE-T, 10GBASE-T
- 규격 이름의 의미  
  10BASE5를 예시로 들면
  - 10 : 전송속도 10Mbps
  - Base : (Baseband)주파수 변경 없이 디지털 신호를 전송매체에 그대로 싫어 보냄
    - ↔ Broadband : 여러개의 다른 주파수로 변조 전송하여 신호를 많이 보냄.
  - 5 : 케이블의 종류, 500m 동축 케이블
    - 2 : 185m 동축케이블
    - T : twisted pair UTP케이블
    - F : Fiber Optic 광케이블

## 📄 Lesson 16 정리
- 주요 이더넷 규격에는 10BASE5, 10BASE2, 10BASE-T, 10BASEE2, 100BASE-TX, 1000BASE-T, 10GBASE-T가 있다.

*************
<br/><br/><br/><br/>

# 👩‍🏫 4장 키워드 정리
- **데이터 링크계층 (Data Link layer)** :  
  네트워크 기기 간에 데이터를 전송하고 물리 주소를 결정한다.
- **이더넷 (Ethernet)** :  
  컴퓨터 네트워크 기술 중 하나로 전 세계의 사무실이나 가정에서 일반적으로 사용도는 랜에서 가장 많이 사용하는 기술 규칙
- **충돌 (collision)** :  
  데이터를 한 번에 하나만 전송할 수 있는 채널에 전송 장치 두 개가 같은 시점에 패킷을 보낼 때 일어나는 데이터 충돌
- **MAC 주소 (Medium Access Control address)** :  
  랜에 사용되는 네트워크 모델인 이더넷의 물리적인 주소로 컴퓨터 네트워크에서 각각의 기기를 구분하기 위해 사용하는 주소다.
- **스위치 (switch)** :  
  랜을 구성할 때 사용하는 단말기 간 스위칭 기능이 있는 통신 중계 장치.  
  컴퓨터(호스트)에서 특정한 다른 단말기로 패킷을 보낼 수 있는 기능이 있어 통신 효율이 향상된다.
- **전이중 통신 방식 (full-duplex communication)** :  
  전화 회선과 같이 송신과 수신이 동시에 이루어지는 양방향 통신이다.  
  서로 다른 회선이나 주파수를 이용하여 데이터 신호가 충돌되는 상황을 방지한다.  
  스위칭 허브를 사용하면 랜 카드와 허브 간의 동시 송수신이 가능한다.  
- **ARP (Address Resolution Protocol)** :  
  랜네트워크 계층 주소와 데이터 링크 계층 주소 사이의 변환을 담당하는 프로토콜이다.  
  IP주소를 물리 주소인 MAC 주소로 변환하는데 사용한다.
- **ARP 캐시 (ARP Cache)** :    
  가장 최근에 변환한 'IP 대 하드웨어 주소'를 보관하고 있는 램의 한 영역
- **ARP 요청 (ARP Request)** :    
  IP 주소를 대치할 수 있는 물리 주소인 MAC 주소를 찾아내기 위해 보내는 브로드캐스트 패킷 요청이다.
- **ARP 응답 (ARP Reply)** :    
  ARP 요청에 대한 응답으로 요청한 IP주소에 대한 물리 주소인 MAC 주소가 실려 있다.

*************
<br/><br/><br/><br/>

# 👩‍🏫참고링크
이더넷에 대해 조금 더 자세한 설명이 알고 싶다면 👇
[이더넷(Ethernet)🔗](https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&blogId=demonicws&logNo=40118511456) 