---
title:  "[모두의 네트워크] 6장 전송계층"
excerpt: "신뢰할 수 있는 데이터 전송하기"

categories:
  - Network
tags:
  - [Network, 모두의 네트워크]

toc: true
toc_sticky: true
 
date: 2022-03-18
last_modified_at: 2022-03-18
---

~~귀찮아도~~ OSI 모델 4계층인 전송 계층에 대해 알아보자!👏  
전송 계층에 대해 아마도 까먹었을 것 같으니 2장에서 정리했던 데이터 흐름을 복습해보자!
<details>
<summary>데이터 흐름</summary>
<div markdown="1">

```
✔️  일반적으로 5계층(세션계층), 6계층(표현계층)은   7계층(응용계층)에 포함되어 생각 할 수 있다.

                                        데이터 송신부                                                    데이터 수신부
응용계층                           (웹사이트 요청데이터)                      ↓                   ↑   (웹사이트 요청 데이터)
------------------------------------------------------------------------------↓ 캡             역 ↑---------------------------------------------
전송계층                      [전송계층헤더]--> (데이터)                      ↓ 슐             캡 ↑   [전송계층헤더]<-- (데이터)
------------------------------------------------------------------------------↓ 화             슐 ↑----------------------------------------------
네트워크계층        [네트워크계층헤더]--> (헤더)(데이터)                      ↓                화 ↑   [네트워크계층헤더]<-- (헤더)(데이터)
------------------------------------------------------------------------------↓                   ↑----------------------------------------------
데이터링크계층  [데이터링크계층]--> (헤더)(헤더)(데이터) <--[데이터링크계층]  ↓                   ↑   [데이터링크계층]<-- (헤더)(헤더)(데이터) -->[데이터링크계층]
                      헤더                                      트레일러      ↓                   ↑        헤더                                      트레일러
------------------------------------------------------------------------------↓-------------------↑----------------------------------------------   
물리계층                                                                      +-->전기신호 변환>--+ 
                                                                         (헤더)(헤더)(헤더)(데이터)(트레일러)
🤓 트레일러 : 데이터에 전달할때 마지막에 추가하는 정보
🤓 [데이터링크계층 헤더][네트워크계층 헤더][전송계층 헤더][웹사이트 요청데이터][데이터링크계층 트레일러] 가 전기신호로 변환되어 수신측에 도착.
```
</div>
</details>

*********************
<br/><br/><br/>

# ✏️ Lesson 23 
## ✔️ 전송 계층의 두 가지 역할

1. 목적지에 신뢰 할수 있는 데이터를 전달
- 오류를 점검하는 기능 : 오류가 발생하면 데이터를 재전송
2. 전송된 데이터의 목적지가 어떤 어플리케이션인지 식별
- 컴퓨터가 데이터를 받았는데 어떤 어플리케이션에 전달해야하는지 모르면 곤란하잖아~


## ✔️ 연결형 통신과 비연결형 통신
### 연결형 통신
신뢰할 수 있고 정확한 데이터 전달
- 상대편과 확인해가며 통신하는 방식  
  ex) 보내도돼? > 응! > 보냈다! > 받았다! > 확인했다!
- 통신 프로토콜 : **TCP**
### 비연결형 통신
효율적인 데이터 전달
- 일방적인 데이터 전송  
  ex) 나 보냈다~
- 동영상 볼 때 사용하는 통신 방식
- 통신 프로토콜 : **UDP**
 
## 📄 Lesson 23 정리
- 전송 계층은 데이터를 제대로 전달하는 역할을 하며, 오류를 점검하는 기능도 한다.
- 전송 계층은 전송된 데이터의 목적지가 어떤 어플리케이션인지 확인한다.
- 연결형 통신은 신뢰 할 수 있고 정확하게 데이터를 전송하는 방식
- 비연결형 통신은 신뢰를 보장하지 않지만 효율적으로 데이터를 전송하는 통신 방식

*************
<br/><br/><br/><br/>

# ✏️ Lesson 24 TCP의 구조
## ✔️ TCP란?
: 연결형 통신 프로토콜
- TCP 헤더 : ~~엄청 기네..~~
  - 출발지 포트 번호 + 목적지 포트 번호 + 일련번호 + 확인응답 번호 +   
    헤더 길이 + 예약 영역 + 코드비트 + 윈도우 크기 +   
    체크섬 + 긴급포인터 + 옵션
- **세그먼트** = TCP 헤더 + 데이터
  - (네트워크 계층에서는 헤더 + 데이터를 **패킷**이라고 했었다)
  - (데이터 링크 계층에서는 헤더 + 데이터를 **프레임**이라고 했었다)

### 코드비트(Connection)
:데이터를 전송하려면 커넥션이라는 가장의 독점 통신로를 확보해야한다.
- TCP 헤더의 코드비트 : 6비트로 커넥션의 제어정보가 기록되는 공간
  - `URG`, `ACK`, `PSH`, `RST`, `SYN`, `FIN` 각 1비트
  - 초기값은 0, 활성화시 1
  - `SYN` : 연결 요청
  - `ACK` : 확인 응답

## ✔️ 3-way 핸드셰이크란?

### Connection
`SYN`, `ACK`를 이용하여 커넥션을 확립하며 요청을 3번 교환하는 것
PC1 -> PC2
> 1. 통신을 하려면 PC1에서 PC2로 연결 확립 허가를 받기위한 요청 `SYN`을 보낸다.  
>   `SYN` : 1, `ACK` : 0
> 2. PC2는 PC1이 보낸 요청을 받은 후에 허가한다는 회신으로 `ACK`를 보낸다.  
> 동시에 PC2도 PC1으로 데이터 전송 허가를 위한 연결 확립 허가 요청 `SYN`을 보낸다.  
>   `SYN` : 1, `ACK` : 1
> 3. PC2의 요청을 받은 PC1 은 PC2로 허가한다는 응답으로 `ACK`를 보낸다.  
>   `SYN` : 0, `ACK` : 1


### 연결 종료를 위한 핸드셰이크
> 1. PC1에서 PC2로 연결 종료 요청 `FIN`을 보낸다.  
>   `FIN` : 1, `ACK` : 0
> 2. PC2에서 PC1로 연결 종료 응답 `ACK`를 보낸다.  
>   동시에 PC2에서 PC1로도 연결 종료 요청 `FIN`를 보낸다.  
>   `FIN` : 1, `ACK` : 1
> 4.  PC1에서 PC2로 연결 종료 응답 `ACK`를 보낸다.  
>   `FIN` : 0, `ACK` : 1

## 📄 Lesson 24 정리
- 전송 계층에서 TCP헤더가 붙는다.
- TCP 헤더가 붙은 데이터를 세그먼트라고 하낟.
- 연결(Connection)을 확립하기 위해 TCP헤더에 있는 코드 비트를 사용한다.
- 코드 비트중 `SYN`은 연결 요청 `ACK`는 연결 응답, `FIN`은 연결 종료를 뜻한다.
- 연결 확립을 위해 패킷 교환을 3번 하는데 이를 3-way 핸드셰이크라고 한다.
- 연결을 확립할 때는 `SYN`와 `ACK`를 사용하고, 연결을 종료할때는  `FIN`과 `ACK`를 사용한다.

*************
<br/><br/><br/><br/>

# ✏️ Lesson 25 일련번호 확인 응답 번호의 구조
## ✔️ 일렬번호와 확인 응답 번호란?
- TCP 헤더 :  
  출발지 포트 번호 + 목적지 포트 번호 + **일련번호(32bit)** + **확인응답 번호(32bit)** +   
  헤더 길이 + 예약 영역 + 코드비트 + 윈도우 크기 +   
  체크섬 + 긴급포인터 + 옵션
- 일련번호  
송신측에서 수신측에 '이 데이터가 몇 번째 데이터인지'알려주는 역할
- 확인 응답 번호  
수신측이 '몇 번째 데이터를 수신했는지' 송신측에 알려주는 역할.  
  - 다음 번호의 데이터를 요청하는데도 사용
![image](https://user-images.githubusercontent.com/48314521/158976402-6f86d626-ec8c-4346-b548-c7e8ccc7e20a.png)
<span stype="font-size=0.8em; color=black;">출처 : https://better-together.tistory.com/140</span>  
- 데이터 전송이 완료될 때까지 위 과정을 반복한다.
- **재전송 제어** : 위 과정 중 데이터가 손상되거나 유실되면 데이터를 재전송한다.

## ✔️ 윈도우 크기란?
### 버퍼와 오버플로
- 세그먼트를 연속해서 보내고 난 다음에 확인응답을 반환하면 효율이 높아진다.
- 수신 측에 세그먼트가 쌓이면 **'버퍼'**에 임시보관한다.
- 만약 수식 측에 대량 데이터가 전송되면 보관하지 못하고 넘치는데, 이를 **오버플로**라고 한다.
- 따라서 버퍼의 한계크기(**윈도우 크기**)를 알아야 한다.

### 윈도우 크기
얼마나 많은 데이터를 저장해 둘 수 있는지 나타내는 것
- 세그먼트마다 확인응 답을 일일히 하지 않고 연속해서 송수신 할 수 있는 데이터 크기다.
- 3-way handshake때 윈도우 크기를 판단한다.
  - ex) PC1의 한계값이 3000, PC2의 한계값이 2000 바이트
  1. `SYN` (PC1 -> PC2) : 윈도우 크기-3000
  2. `ACK`,`SYNC` (PC2 -> PC1) : 윈도우 크기-2000
  3. 'ACK' (PC1 -> PC2)

![image](https://user-images.githubusercontent.com/48314521/158979997-ebedd806-6db4-4604-876c-f2482491b7ad.png)
<span stype="font-size=0.8em; color=black;">출처 : https://better-together.tistory.com/140</span>  

## 📄 Lesson 25 정리
- 3-way handshake 이 후 데이터를 전송할 때는 TCP 헤더의 일련번호와 확인 응답 번호가 사용된다.
- 데이터를 재전송하는 것을 재전송 제어라고 한다.
- 수신한 세그먼트(데이터)를 일시적으로 저장하는 장소를 버퍼라고 한다.
- 데이터 크기가 버퍼크기를 넘어서는 것을 오버플로라고 한다.
- 버퍼 용량의 크기를 윈도우 크기라고한다.


*************
<br/><br/><br/><br/>

# ✏️ Lesson 26 포트 번호의 구조
## ✔️ 포트 번호란?
- 어느 어플리케이션의 데이터인지 알 기 위해 필요한 정보
- 출발지 포트번호, 목적지 포트 번호가 TCP 헤더에 포함되어 있다.
- 포트번호는 0~65535 번까지 사용가능하다.
- 0 ~ 1023은 주요 프로토콜이 사용하도록 예약되어 있고 **well-known ports**라고 한다.
- 1024 이상은 **랜덤포트**라고 클라이언트의 송신 포트로 사용된다.  
- 
| 애플리케이션 | SSH | SMTP | DNS | HTTP | POP3 | HTTPS |
|:----------|:----:|:----:|:-----:|:------:|:------:|:-----:|
| 포트번호 | 22 | 25 | 53 | 80 | 110 | 443 |  


## 📄 Lesson 26 정리
- 포트 번호는 어떤 어플리케이션인지 구분하는 역할을 한다.
- 포트번호는 0~65535번을 사용한다.
- 포트번호 0~1023은 well-knwown ports라고 한다.

*************
<br/><br/><br/><br/>

# ✏️ Lesson 27 UDP의 구조
## ✔️ UDP란?
비연결형 통신 프로토콜
- 데이터 송수신 확인 작업이 없다.
- 효율성을 중요하게 여긴다.
- 데이터를 빠르게 효율적으로 보내는 것이 장점이라 동영상 서비스 같은 곳에 사용된다.

## ✔️ UDP 헤더란?
- UDP헤더 :
  - 출발지 포트번호 + 목적지 포트번호 + 길이 + 체크섬
- **데이터 그램** = UDP 헤더 + 데이터
  - 데이터링크 :   , 네트워크 : 패킷, TCP : 세그먼트
- 브로드캐스트  
랜에 있는 컴퓨터나 네트워크 장비에 데이터를 일괄로 보낼 수 있다.

## 📄 Lesson 27 정리
- UDP는 데이터를 효율적이고 빠르게 보낼 때 사용되는 프로토콜이다.
- UDP는 UDP 헤더가 있지만 TCP 헤더에 비해 간단하다.
- UDP 헤더가 있는 데이터를 데이터그램이라고 한다.
- UDP는 랜에서 불특정 다수에게 브로드캐스트로 데이터를 일괄 전송한다.

*************
<br/><br/><br/><br/>

# 👩‍🏫 6장 키워드 정리
- **전송 계층(transport layer)** :  
  신뢰할 수 있는 데이터를 순차적으로 전달하는 역할을 하므로 상위 계층들이 데이터 전달의  
  유효성이나 효율성을 신경쓰지 않도록 한다.  
  데이터가 누락되거나 중복되지 않고 오류없이 순서에 맞게 전송되도록 관리한다.
- **연결형 (connection-oreiented)** :  
  데이터를 교환하기 전에 연결을 맺고 데이터를 교환하는 동안 계속 연결을 관리하는 프로토콜의 한 형태이다.
- **비연결형 (connectionless)** :  
  연결에 대한 초기화 과정이 없는 통신이다.
- **TCP (Transmission Control Protocol)** :  
  전송 계층의 프로토콜은 연결형 통신방식이며 신뢰 할 수 있는 데이터 전송을 보장한다.
- **대역폭 (bandwidth)** :  
  정해진 시간동안 전송될 수 있는 데이터의 양(주로 속도)을 말한다. 대역폭은 제한적이다.
- **UDP (User Diagram Protocol)** :  
  정보를 서로 주고 받을 때 보내는 쪽에서 일방적으로 데이터를 전달하는 통신 프로토콜이다.  
  연결을 맺을 필요가 없고 정보를 보내거나 받는다는 신호도 필요하지 않다.
- **3-way handshake** :  
  TCP 통신에서 사용하는 신뢰성을 제공하기 위한 통신 방식이다.  
  컴퓨터 간에 연결을 맺기 위한 초기화 과정으로 세 단계로 되어 있어서 3-way로 불린다.
- **well-known ports** :    
  특정 애플리케이션이 사용할 수 있도록 예약되어 있는 포트로 0~1023 포트를 말한다.
- **브로드 캐스트 (broadcase)** :
  네트워크의 모든 컴퓨터와 장비에 같은 패킷을 일괄 전송하는 방식이다.
- **일련번호 (seqeunce number)** :
  TCP에서는 데이터를 보낼 때마다 각 데이터에 고유한 번호를 부여해서 전송을 시도한다.  
  이 번호를 이용하여 TCP 패킷의 순서를 제어할 수 있다.
- **포트번호 (port number)** :
  컴퓨터가 데이터 통신을 할 때 통신하고자 하는 네트워크 서비스나 특정 프로세스를 식별하는 논리 단위이다.  
  포트번호는 0~65536번을 사용할 수 있는데,   
  0~ 1023번은 well-known ports로 특정 어플리케이션이 사용할 수 있도록 예약된 번호다.




*************
<br/><br/><br/><br/>

# 👩‍🏫참고링크
[쉽게 이해하는 네트워크🔗](https://better-together.tistory.com/140)  
[TCP/IP쉽게 더 쉽게🔗](https://m.blog.naver.com/ljh0326s/220888531881)
