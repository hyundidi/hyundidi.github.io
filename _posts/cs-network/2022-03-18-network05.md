---
title:  "[모두의 네트워크] 5장 네트워크 계층"
excerpt: "목적지에 데이터 전달하기"

categories:
  - Network
tags:
  - [Network, 모두의 네트워크]

toc: true
toc_sticky: true
 
date: 2022-03-18
last_modified_at: 2022-03-18
---

~~너무너무 귀찮아도~~ OSI 모델 3계층인 네트워크 계층에 대해 알아보자!👏  
아마도 까먹었을 것 같으니 2장에서 정리했던 데이터 흐름을 복습해보자!
<details>
<summary>데이터 흐름</summary>
<div markdown="1">

```
✔️  일반적으로 5계층(세션계층), 6계층(표현계층)은   7계층(응용계층)에 포함되어 생각 할 수 있다.

                                        데이터 송신부                                                    데이터 수신부
응용계층                           (웹사이트 요청데이터)                      ↓                   ↑   (웹사이트 요청 데이터)
------------------------------------------------------------------------------↓ 캡             역 ↑---------------------------------------------
전송계층                      [전송계층헤더]--> (데이터)                      ↓ 슐             캡 ↑   [전송계층헤더]<-- (데이터)
------------------------------------------------------------------------------↓ 화             슐 ↑----------------------------------------------
네트워크계층        [네트워크계층헤더]--> (헤더)(데이터)                      ↓                화 ↑   [네트워크계층헤더]<-- (헤더)(데이터)
------------------------------------------------------------------------------↓                   ↑----------------------------------------------
데이터링크계층  [데이터링크계층]--> (헤더)(헤더)(데이터) <--[데이터링크계층]  ↓                   ↑   [데이터링크계층]<-- (헤더)(헤더)(데이터) -->[데이터링크계층]
                      헤더                                      트레일러      ↓                   ↑        헤더                                      트레일러
------------------------------------------------------------------------------↓-------------------↑----------------------------------------------   
물리계층                                                                      +-->전기신호 변환>--+ 
                                                                         (헤더)(헤더)(헤더)(데이터)(트레일러)
🤓 트레일러 : 데이터에 전달할때 마지막에 추가하는 정보
🤓 [데이터링크계층 헤더][네트워크계층 헤더][전송계층 헤더][웹사이트 요청데이터][데이터링크계층 트레일러] 가 전기신호로 변환되어 수신측에 도착.
```
</div>
</details>

*********************
<br/><br/><br/>

# ✏️ Lesson 17   

## ✔️ 네트워크 간의 연결 구조
**다른 네트워크에 있는 목적지**로 데이터를 전달하기 위해서는 네트워크 계층의 기술이 필요하다!
```
여러 개의 네트워크가 연결 되어있는 환경
    == 네트워크A ==         == 네트워크B ==
    ‖   스위치    ‖         ‖   스위치    ‖
    ‖   |    |    ‖---------‖   |    |    ‖
    ‖  PC1  PC2   ‖         ‖  PC1  PC2   ‖
    ===============         ===============
🤓 스위치를 통해서는 같은 네트워크 안에서만 통신 할 수 있다.
🤓 네트워크 간의 통신을 가능하게 하는 것이 네트워크 계층의 역할이다
```

### 라우터(router)
: 데이터를 목적지까지 어떤 **경로**로 가는 것이 좋은지 결정하는 기능을 한다.
- 목적지 주소 **IP주소**를 알아야 한다. *MAC 주소는 같은 네트워크 안에서 식별 가능한 주소
- IP 주소  
  어떤 네트워크 어떤 컴퓨터인지 식별할 수 있는 주소  
ex) 네트워크A의 PC1인지, 네트워크B의 PC1 인지
- **라우팅** : 데어터를 어떤 경로로 보낼지 결정하는 것  
  라우팅 또는 레이어3 스위치에서 라우팅을 한다.  
  > 레이어3 스위치 : 네트워크를 분할하여 라우팅을 할 수 있는 장비  

- 라우팅 테이블 : 경로 정보를 등록하고 관리

### IP란?
: Internet Protocol
- IP헤더 : ~~엄청 기네..~~
  - 버전 + 헤더 길이 + 서비스 유형 + 전체패킷길이 + 일련변호(ID) + 조각 상태 +  
    조각의 위치 + TTL + 프로토콜 + 헤더 체크섬 + **출발지 IP주소 + 목적지 IP주소**
- **IP 패킷** = IP 헤더 + 데이터
  - (데이터 링크 계층에서는 헤더 + 데이터를 프레임이라고 했었다)

## 📄 Lesson 17 정리
- 서로 다른 네트워크 간에 통신을 하려면 라우터가 필요하다.
- 랜 안에서는 MAC주소만으로도 통신 할 수 있지만 네트워크 간에 통신을 하려면 IP주소가 필요하다.
- 경로를 선택하고 목적지 IP주소까지 어떻게 데이터를 전달할지 결정하는 것을 라우팅이라고 한다.
- 라우터의 라우팅 테이블에는 경로 정보가 등록되어 있다.
- 네트워크 계층의 대표적인 프로토콜에는 IP가 있다.
- 네트워크 계층에서는 캡슐화 할 때 IP헤더를 추가한다.

*************
<br/><br/><br/><br/>

# ✏️ Lesson 18 IP 주소의 구조
## ✔️ IP 주소란?
: ISP(인터넷 서비스 제공자)에게 받을 수 있다.

### 버전IPv4, IPv6
- IPv4 : 32bit  (약 43억 개의 주소)
  - 인터넷이 널리 보급되면서 43억개로는 IP주소가 부족해짐.
- IPv6 : 128bit (340간 개의 주소) <span style = "font-size:0.7em;color: gray;">천<억<조<경<.</span>

### 공인 IP 주소, 사설 IP 주소
- IPv4 주소는 주소의 수가 고갈되고 있어서 공인 IP 주소, 사설 IP 주소를 나누어 할당한다.
- 공인 IP 주소 : 인터넷에 직접 연결되는 컴퓨터, 라우터에 할당
- 사설 IP 주소 : 회사나 가정의 랜에 있는 컴퓨터에 할당
  - 랜의 네트워크 관리자가 자유롭게 사설 IP 주소를 할당하거나 라우터의 DHCP기능을 사용
  - > DHCP(Dynamic Host Congfiguration Protocol) : IP 주소를 자동으로 할당하는 프로토콜  

```
                    인터넷 서비스 제공자(ISP)
                                ↓
                          공인 IP 주소
   WAN👆                        ↓
-------------------[라우터 (스위치 기능 포함)]----------------
   LAN👇            ↓           ↓           ↓
                   사설        사설        사설    
                  IP주소      IP주소      IP주소
                    ↓           ↓           ↓
                   PC1         PC2         PC3
```
### IP주소 (IPv4)
- 48bit를 10진수로 표현
- 48비트를 8비트(**옥텟**)으로 나눠서 표시하고 10진수로 읽는다  
ex) 11000000 10101000 00000001 00001010 => 192.168.001.010
- IP주소는 **네트워크 ID**, **호스트 ID**로 나뉜다.
  - 네트워크 ID : 어느 네트워크인지
  - 호스트 ID : 해당네트워크에서 어느 컴퓨터인지

## ✔️ 보강 IPv6
현재 주로 사용하는 것은 IPv4(Internet Protocol version4). 32비트  
2^32인 43억개의 컴퓨터에 IP주소를 할당할 수 있는데, 인터넷이 보급되면서 모자라기 시작함.  

그 대책으로 IPv6가 생겼는데, **128비트**로 확장되어서 사실 상 무제한 IP주소를 쓸 수 있게 되었다.
따라서 가정에 있는 tv, 에어컨 등에도 인터넷에 연결이 가능하게 되었다!

## 📄 Lesson 18 정리
- 데이터를 다른 네트워크로 전달하려면 IP주소가 필요하다.
- IP 주소는 인터넷 서비스 공급자에게 할당받을 수 있다.
- IPv4의 IP주소는 32비트, IPv6의 IP주소는 128비트로 구성되어 있다.
- IP 주소의 종류에는 공인 IP 주소와 사설 IP 주소가 있다.
- IP 주소는 네트워크 ID와 호스트 ID로 나누어진다.  

*************
<br/><br/><br/><br/>

# ✏️ Lesson 19 IP 주소의 클래스 구조
## ✔️ IP 주소 클래스란?
### 클래스  

#### 클래스 별 주소 차이

| 클래스이름 | A 클래스 | B 클래스 | C 클래스 | D 클래스 | E 클래스|
|:----------|:----------:|:----------:|:----------:|:----------:|:----------:|
| 내용 | 대규모 네트워크 | 중형 네트워크 | 소규모 네트워크 | 멀티캐스트 | 연구 및 특수용도|

- A 클래스 : `**8**bit [네트워크 ID]` + `24bit [호스트 ID]`
- B 클래스 : `**16**bit [네트워크 ID]` + `16bit [호스트 ID]`
- C 클래스 : `**24**bit [네트워크 ID]` + `8bit [호스트 ID]`

#### 주소 범위
- 공인 IP 주소 범위
  - A 클래스 : `1.0.0.0 ~ 126.255.255.255` 중 `10.0.0.0 ~ 10.255.255.255` 제외
  - B 클래스 : `128.0.0.0 ~ 191.15.255.255` 중 `172.16.0.0 ~ 172.31.255.255` 제외
  - C 클래스 : `192.0.0.0 ~ 223.255.255.255` 중 `1912.68.0.0 ~ 192.168.255.255` 제외

- 사설 IP 주소 범위
  - A 클래스 : `10.0.0.0 ~ 10.255.255.255`
  - B 클래스 : `172.16.0.0 ~ 172.31.255.255`
  - C 클래스 : `1912.68.0.0 ~ 192.168.255.255`  <= 가정에서 많이 쓰는 사설 IP 주소  
    *ipconfig 명령어로 개인 IP주소 확인가능

## 📄 Lesson 19 정리
- IP 주소는 `A~E` 클래스로 나누어지며 일반적으로는 A~C 클래스를 사용한다.
- IP 주소의 클래스별 호스트 수는 A 클래스가 1677만 7214대, B 클래스가 6만 5534대, C 클래스가 254대이다.

*************
<br/><br/><br/><br/>

# ✏️ Lesson 20 네트워크 주소와 브로드캐스트 주소의 구조
## ✔️ 네트워크 주소와 브로드캐스트 주소의 구조
IP 주소에는 컴퓨터에 할당할 수 없는 주소인 네트워크 주소와 브로드 캐스트 주소가 있다.

### 네트워크 주소
: 호스트 아이디가 0인 주소   
- 전체 네트워크에서 작은 네트워크를 식별하는데 사용!  
- 네트워크의 대표 주소  
- ex) 192.168.1.1 IP 주소를 가진 컴퓨터는 192.168.1.0 네트워크에 있다.

### 브로드캐스트 주소
: 호스트 아이디가 FF인 주소
- 네트워크에 있는 컴퓨터나 장비 모두에게 한번에 데이터를 전송하는데 사용하는 전용 IP주소
- ex)192.168.1.255로 전송시 192.168.1.0 네트워크 안의 모든 컴퓨터로 송신

## 📄 Lesson 20 정리
- 네트워크 주소와 브로드캐스트 주소는 컴퓨터에 설정할 수 없다. 


*************
<br/><br/><br/><br/>

# ✏️ Lesson 21 서브넷의 구조
## ✔️ 서브넷
: 작게 분할된 네트워크
- 큰 네트워크를 작게 분할 하는 것을 **서브넷팅**이라고 한다.  
  - ex) A 클래스의 대규모 네트워크를 분할하여 브로드 캐스트로 전송되는 패킷의 범위를 좁힐 수 있다.
- 호스트 ID를 빌려서 서브넷 ID로 만들면 된다.  
  서브넷팅 전 : `8bit [네트워크 ID]` + `24bit [호스트 ID]`        
  서브넷팅 후 : `8bit [네트워크 ID]` + `10bit [서브넷 ID]` + `14bit [호스트 ID]`

## ✔️ 서브넷 마스크란?
: 네트워크 ID와 호스트ID를 식별하기 위한 값
- 호스트 ID는 0, 네트워크 ID는 1
- A 클래스 : 255.0.0.0
- B 클래스 : 255.255.0.0
- C 클래스 : 255.255.255.0
- 프리픽스 표기법 : 서브넷 마스크를 슬래시(/비트수)로 나타낸 것.
  - A 클래스 : /8
  - B 클래스 : /16
  - C 클래스 : /24
- C 클래스 서브넷팅 전과 후 : 네트워크 ID를 28bit로 변경
  - 전 : `11111111 11111111 11111111 00000000`  255.255.255.0
  - 후 : `11111111 11111111 11111111 11110000`  255.255.255.240  /28

## 📄 Lesson 21 정리
- 네트워크를 분할하는 것을 서브넷팅이라고 분할된 네트워크를 서브넷이라고 한다.
- 서브넷팅되면 구성이 '네트워크 ID + 호스트 ID'에서 '네트워크 ID + 서브넷 ID + 호스트 ID'로 변경된다.
- 서브넷 마스크는 네트워크 주소와 호스트 주소를 식별하는 값이다.
- 클래스별로 서브넷 마스크는 A 클래스가 255.0.0.0, B 클래스가 255.255.0.0, C 클래스가 255.255.255.0이다.
- 프리픽스 표기법은 서브넷 마스크를 슬래시(/비트)로 나타낸다. 예를 들어 255.255.255.0을 프리픽스 표기법으로 나타내면 /24다.

*************
<br/><br/><br/><br/>

# ✏️ Lesson 22 라우터의 구조
## ✔️ 라우터란?
: 다른 네트워크와 통신하려면 라우터가 필요하다.
```
                        +-----------+
                        |   라우터  |
                        +-----------+
                            |   |
                            |   |
    === 192.168.1.0/24 ===  |   |  === 192.168.2.0/24 ===
    ‖    스위치(Layer2)--+--+   +--+--스위치(Layer2)    ‖
    ‖    |    |    |     ‖         ‖    |    |    |     ‖
    ‖   PC1  PC2  PC3    ‖         ‖   PC1  PC2  PC3    ‖
    ======================         ======================
🤓 스위치(L2)만 있는 네트워크에서는 모든 컴퓨터와 스위치가 동일한 네트워크에 속한다. 허브도 마찬가지
🤓 라우터를 통해 네트워크를 분리할 수 있다.
```

### 기본 게이트웨이
라우터의 IP주소 설정
- 192.168.1.0의 PC1   ->  192.168.2.0의 PC2로 데이터를 보낸다고 했을때, PC1은 데이터를 어디로 전송해야 하는지 모른다.
  따라서, 네트워크의 출입구를 지정하고 일단 라우터로 데이터를 전송한다.

## ✔️ 라우팅이란?
경로 정보를 기반으로 현재 네트워크에서 다른 네트워크로 최적의 경로를 결정
- 라우팅 테이블 : 경로 정보가 등록되어 있는 테이블
- 수동/자동으로 라우팅 테이블을 등록할 수 있음. 수동은 소규모에 적합.
- 라우팅 프로토콜 : 라우터 간에 라우팅 정보를 교환하기 위한 프로토콜
  - ex) RIP, OSPF, BGP ...

## 📄 Lesson 22 정리
- 서로 다른 네트워크와 통신하려면 라우터가 필요하다.
- 라우터는 네트워크를 분할할 수 있지만 스위치(L2)와 허브는 분할 할 수 없다.
- 컴퓨터에서 다른 네트워크로 데이터를 전송하려면 기본 게이트웨이를 설정해야 한다.
- 라우팅은 경로 정보를 기반으로 현재 네트워크에서 다른 네트워크로 최적의 경로를 통해 데이터를 전송하는 방식이다.
- 경로 정보가 등록되어 있는 테이블을 라우팅 테이블이라고 한다.
- 라우터간에 라우팅 정보를 서로 교환하기 위한 프로토콜을 라우팅 프로토콜이라고 한다.


*************
<br/><br/><br/><br/>

# 👩‍🏫 5장 키워드 정리
- **네트워크계층 (Network layer)** :  
  다른 네트워크와 통신하기 위한 경로설정을 위해 라우터를 통한 라우팅을 하며 패킷전송을 담당한다.
- **IP (Internet Protocol)** :  
   인터넷에 있는 한 컴퓨터에서 다른 컴퓨터로 보내는데 사용되는 네트워크 계층 프로토콜이다.
- **IP 주소 (IP address)** :  
  컴퓨터 네트워크에서 장치들이 서로를 인식하고 통신하기 위해 사용하는 주소이다.
- **IP 주소 클래스(IP address clasee)** :  
  IPv4에서 사용하는 주소 그룹에는 A,B,C,D,E 다섯개가 있다.  
  A~C 클래스는 네트워크ID + 호스트ID로 구성되며  
  D 클래스는 멀티캐스트 주소로 사용된다.  
  E 클래스는 필요에 따라 사용하기 위해 확보해 놓은 것이다.
- **라우터 (router)** :  
  서로 다른 네트워크를 연결해 주는 장치로 현재의 네트워크에서 다른 네트워크로 패킷을 전송할 수 있도록 한다.
- **라우팅 (routing)** :   
  네트워크에서 패킷을 목적지로 보낼 때 목적지까지 갈 수 있는 여러 가지 경로 중 한 개를 설정핸 주는 과정.
- **라우팅 테이블 (routing table)** :  
  컴퓨터 네트워크엥서 목적지 주소를 목적지에 도달하기 위한 네트워크 노선으로 변환시킬 목적으로 사용한다.  
  다른 네트워크로 가기 위한 가장 좋은 라우터의 정보를 가지고 있다.
- **서브넷 (subnet)** :    
  큰 네트워크를 분할해서 만든 작은 네트워크
- **서브넷팅 (subneting)** :    
  네트워크를 분할하기 위해 IP주소의 구성을 변경하는 작업
- **서브넷 ID** :    
  IP 주소의 네트워크 부분을 늘리기 위해 서브넷 마스크로 활용되는 비트로 서브넷 비트라고도 한다.
- **서브넷 마스크 (subnet mask)**
  IP 주소의 네트워크 부분만 나타나게하여 같은 네트워크인지 판별하게 하는 마스크다.
- **멀티캐스트 (multicast)**
  한 컴퓨터(호스트)에서 패킷을 여러 컴퓨터로 동시에 전달하는 것
- **브로드캐스트 (broadcast)**
  IP 네트워크에 있는 모든 컴퓨터(호스트)로 데이터를 전송하는 방식
